
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pearl Dodecagon with Section Shades</title>
<style>
  html,body{
    margin:0;height:100%;overflow:hidden;
    background:#000;font-family:sans-serif;
  }
  /* --- 12 perfectly tiled vertical bars --- */
  .bar{
    position:absolute;
    top:0;height:100%;
    width:calc(100% / 12);
  }
  /* precise left offsets */
  .bar:nth-child(1)  {left:calc(100%/12*0); background:#FF0018;}
  .bar:nth-child(2)  {left:calc(100%/12*1); background:#FFA52C;}
  .bar:nth-child(3)  {left:calc(100%/12*2); background:#FFFF41;}
  .bar:nth-child(4)  {left:calc(100%/12*3); background:#008018;}
  .bar:nth-child(5)  {left:calc(100%/12*4); background:#0000F9;}
  .bar:nth-child(6)  {left:calc(100%/12*5); background:#86007D;}
  .bar:nth-child(7)  {left:calc(100%/12*6); background:#FFFFFF;}
  .bar:nth-child(8)  {left:calc(100%/12*7); background:#000000;}
  .bar:nth-child(9)  {left:calc(100%/12*8); background:#784F17;}
  .bar:nth-child(10) {left:calc(100%/12*9); background:#FF69B4;}
  .bar:nth-child(11) {left:calc(100%/12*10);background:#00CED1;}
  .bar:nth-child(12) {left:calc(100%/12*11);background:#808080;}
  
  /* Bar number captions */
  .bar::before{
    content:attr(data-num);
    position:absolute;
    top:10px;
    left:50%;
    transform:translateX(-50%);
    font-family:'Georgia',serif;
    font-weight:bold;
    font-size:2.5vmin;
    background:linear-gradient(45deg,#f5d76e 0%,#ffcc00 20%,#d4a017 40%,#ffd700 60%,#b8860b 80%,#ffcc00 100%);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    text-shadow:
      0 0 4px rgba(255,215,0,0.6),
      0 0 8px rgba(255,223,100,0.4),
      1px 1px 2px rgba(0,0,0,0.7);
    z-index:4;
  }
  
  /* drifting vertical shimmer - FIXED with pseudo-element approach */
  .clouds{
    position:absolute;
    inset:0;
    z-index:5;
    pointer-events:none;
    overflow:hidden;
  }
  .clouds::before{
    content:'';
    position:absolute;
    width:100%;
    height:200%;
    top:0;
    left:0;
    background:repeating-linear-gradient(
      180deg,
      rgba(255,255,255,0.05) 0,
      rgba(255,255,255,0.05) 4px,
      transparent 4px,
      transparent 40px,
      rgba(255,255,255,0.05) 40px,
      rgba(255,255,255,0.05) 44px,
      transparent 44px,
      transparent 80px
    );
    animation:driftUp 6s linear infinite;
  }
  @keyframes driftUp{
    0%{transform:translateY(0);}
    100%{transform:translateY(-80px);}
  }
  
  #c{position:absolute;top:0;left:0;width:100%;height:100%;z-index:10;}
  
  /* gold glitter center text */
  #goldText{
    position:fixed;
    top:50%;left:50%;
    transform:translate(-50%,-50%);
    z-index:50;
    font-family:'Georgia',serif;
    font-weight:900;
    font-size:18vmin;
    letter-spacing:2px;
    text-align:center;
    background:linear-gradient(45deg,#f5d76e 0%,#ffcc00 20%,#d4a017 40%,#ffd700 60%,#b8860b 80%,#ffcc00 100%);
    -webkit-background-clip:text;
    color:transparent;
    text-shadow:
      0 0 8px rgba(255,215,0,0.6),
      0 0 12px rgba(255,223,100,0.4),
      2px 2px 4px rgba(0,0,0,0.5);
    animation:shine 3s linear infinite;
  }
  .blink{animation:blink 0.3s step-start infinite;}
  @keyframes blink {50%{opacity:0;}}
  @keyframes shine {0%{background-position:0 0;}100%{background-position:200% 0;}}
  
  #overlay{
    position:fixed;inset:0;
    display:flex;align-items:center;justify-content:center;
    z-index:60;color:#fff;background:rgba(0,0,0,0.5);
    font-size:1.2rem;
  }
</style>
</head>
<body>
<!-- 12 perfectly even vertical bars with number labels -->
<div class="bar" data-num="40"></div><div class="bar" data-num="41"></div>
<div class="bar" data-num="42"></div><div class="bar" data-num="43"></div>
<div class="bar" data-num="44"></div><div class="bar" data-num="45"></div>
<div class="bar" data-num="46"></div><div class="bar" data-num="47"></div>
<div class="bar" data-num="48"></div><div class="bar" data-num="49"></div>
<div class="bar" data-num="50"></div><div class="bar" data-num="51"></div>

<div class="clouds"></div>
<canvas id="c"></canvas>
<div id="overlay">Press any key or tap to start (key toggles fullscreen)</div>
<div id="goldText" class="blink">?</div>

<script>
const SOUND_BASE="https://cubicpostcode.com/screensaver/";
const COLORS=['#FF0018','#FFA52C','#FFFF41','#008018','#0000F9','#86007D',
              '#FFFFFF','#000000','#784F17','#FF69B4','#00CED1','#808080'];
const NOTES=Array.from({length:12},(_,i)=>SOUND_BASE+`note${40+i}.mp3`);
const TRAVEL_TIME=8, SILENCE=2, FREEZE=0.5;

const canvas=document.getElementById('c');
const ctx=canvas.getContext('2d');
let W,H,CX,CY,R,DPR;
function resize(){
  DPR=window.devicePixelRatio||1;
  W=innerWidth;H=innerHeight;
  CX=W/2;CY=H/2;R=Math.min(W,H)*0.45;
  canvas.width=W*DPR;canvas.height=H*DPR;
  canvas.style.width=W+'px';canvas.style.height=H+'px';
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
resize();addEventListener('resize',resize);

function sectionGradient(base,x,y,r){
  // Convert hex to RGB
  const rgb = base.match(/\w\w/g).map(c=>parseInt(c,16));
  const g = ctx.createRadialGradient(x-r*0.3,y-r*0.3,r*0.1,x,y,r);
  g.addColorStop(0,`rgba(${rgb[0]},${rgb[1]},${rgb[2]},1)`);
  g.addColorStop(0.5,`rgba(${rgb[0]},${rgb[1]},${rgb[2]},0.7)`);
  g.addColorStop(1,`rgba(${rgb[0]},${rgb[1]},${rgb[2]},0.4)`);
  return g;
}
function goldGradient(x,y,r){
  const g=ctx.createLinearGradient(x-r,y-r,x+r,y+r);
  g.addColorStop(0,'#f5d76e');
  g.addColorStop(0.2,'#ffcc00');
  g.addColorStop(0.4,'#d4a017');
  g.addColorStop(0.6,'#ffd700');
  g.addColorStop(0.8,'#b8860b');
  g.addColorStop(1,'#ffcc00');
  return g;
}

class Dodecagon{
  constructor(i){
    const seg=Math.PI*2/12;
    this.idx=i;
    this.ang=seg*i-Math.PI/2+seg/2;
    this.x=CX;this.y=CY;
    this.radius=0;
    this.speed=R/TRAVEL_TIME;
    this.target=[CX+Math.cos(this.ang)*R, CY+Math.sin(this.ang)*R];
    this.travelled=0;
    this.note=40+i;
    this.audio=new Audio(NOTES[i]);
    this.audio.crossOrigin='anonymous';
    this.played=false;this.freezeEnd=null;
    this.showNumber=false;
    this.startTime=performance.now();
    this.baseColor=COLORS[i]; // store section color
  }
  update(dt,t){
    if(this.freezeEnd && t>this.freezeEnd){this.done=true;return;}
    if(!this.played){this.audio.play().catch(()=>{});this.played=true;}
    const move=this.speed*dt;
    this.x+=Math.cos(this.ang)*move;
    this.y+=Math.sin(this.ang)*move;
    this.travelled+=move;
    this.radius = R * 0.12 * (this.travelled/R);
    if(this.travelled>=R/2 && !this.showNumber){
      this.showNumber=true;
      const txt=document.getElementById('goldText');
      txt.textContent=this.note;
      txt.classList.remove('blink');
    }
    const remain=Math.hypot(this.target[0]-this.x,this.target[1]-this.y);
    if(remain<2 && !this.freezeEnd){this.freezeEnd=t+FREEZE;}
  }
  draw(){
    ctx.beginPath();
    for(let k=0;k<12;k++){
      const a = (Math.PI*2/12)*k;
      const px = this.x + this.radius * Math.cos(a);
      const py = this.y + this.radius * Math.sin(a);
      if(k===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
    }
    ctx.closePath();
    // section-colored pearl gradient
    ctx.fillStyle=sectionGradient(this.baseColor,this.x,this.y,this.radius);
    ctx.fill();
    ctx.lineWidth=1.5;
    ctx.strokeStyle='rgba(255,255,255,0.7)';
    ctx.stroke();

    // Laser-like reflection
    const time=(performance.now()-this.startTime)/1000;
    ctx.save();
    ctx.clip();
    ctx.globalAlpha=0.25;
    const angle=time*0.5;
    const grad=ctx.createLinearGradient(
      this.x + Math.cos(angle)*this.radius,
      this.y + Math.sin(angle)*this.radius,
      this.x - Math.cos(angle)*this.radius,
      this.y - Math.sin(angle)*this.radius
    );
    grad.addColorStop(0,'rgba(255,255,255,0)');
    grad.addColorStop(0.5,'rgba(255,255,255,0.7)');
    grad.addColorStop(1,'rgba(255,255,255,0)');
    ctx.fillStyle=grad;
    ctx.fill();
    ctx.restore();

    // moving laser stripe
    const stripePos=(time*80)% (this.radius*2);
    ctx.save();
    ctx.clip();
    ctx.globalAlpha=0.3;
    const stripeGrad=ctx.createLinearGradient(
      this.x-stripePos,this.y-stripePos,
      this.x+stripePos,this.y+stripePos
    );
    stripeGrad.addColorStop(0,'rgba(255,255,255,0)');
    stripeGrad.addColorStop(0.5,'rgba(255,255,255,0.8)');
    stripeGrad.addColorStop(1,'rgba(255,255,255,0)');
    ctx.fillStyle=stripeGrad;
    ctx.fill();
    ctx.restore();

    // golden number
    if(this.showNumber){
      ctx.save();
      ctx.font=`${this.radius*0.9}px Georgia`;
      ctx.textAlign='center';
      ctx.textBaseline='middle';
      ctx.fillStyle=goldGradient(this.x,this.y,this.radius);
      ctx.shadowColor='rgba(0,0,0,0.6)';
      ctx.shadowBlur=6;
      ctx.fillText(this.note,this.x,this.y);
      ctx.restore();
    }
  }
}

let running=false,current=null,nextTime=0,last=null;
function loop(ts){
  if(!last) last=ts;
  const dt=(ts-last)/1000; last=ts;
  ctx.clearRect(0,0,W,H);
  drawWheel();
  const t=performance.now()/1000;
  if(running){
    if(current){
      current.update(dt,t);
      current.draw();
      if(current.done){
        current=null;
        const txt=document.getElementById('goldText');
        txt.textContent='?';
        txt.classList.add('blink');
        nextTime=t+SILENCE;
      }
    } else if(t>=nextTime){
      current=new Dodecagon(Math.floor(Math.random()*12));
    }
  }
  requestAnimationFrame(loop);
}

function drawWheel(){
  const seg=Math.PI*2/12;
  for(let i=0;i<12;i++){
    ctx.beginPath();
    ctx.moveTo(CX,CY);
    ctx.arc(CX,CY,R,seg*i-Math.PI/2,seg*(i+1)-Math.PI/2);
    ctx.closePath();
    ctx.fillStyle=COLORS[i];
    ctx.fill();
  }
  ctx.beginPath();
  ctx.arc(CX,CY,R,0,Math.PI*2);
  ctx.lineWidth=2;
  ctx.strokeStyle='rgba(255,255,255,0.1)';
  ctx.stroke();
}
requestAnimationFrame(loop);

function start(){
  if(!running){
    running=true;
    document.getElementById('overlay').style.display='none';
  } else {
    if(!document.fullscreenElement) document.documentElement.requestFullscreen();
    else document.exitFullscreen();
  }
}
document.addEventListener('keydown',start);
document.addEventListener('pointerdown',start);
</script>
</body>
</html>
